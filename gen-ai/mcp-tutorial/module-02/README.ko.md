# MCP μ„λ²„ λ°°ν¬ λ° Claude Desktop μ—°κ²° μ„¤μ •

## κ°μ”
μ΄ λ¨λ“μ—μ„λ” MCP(Model Context Protocol) μ„λ²„λ¥Ό AWS CDKλ¥Ό μ‚¬μ©ν•μ—¬ AWS ν™κ²½μ— λ°°ν¬ν•κ³ , Claude Desktop μ• ν”λ¦¬μΌ€μ΄μ…κ³Ό μ—°κ²°ν•λ” λ°©λ²•μ„ ν•™μµν•©λ‹λ‹¤. μ¤‘μ•™ μ§‘μ¤‘μ‹ MCP μ„λ²„λ¥Ό κµ¬μ¶•ν•μ—¬ μ—¬λ¬ μ‚¬μ©μλ‚ μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„ κ³µμ ν•  μ μλ” ν™κ²½μ„ κµ¬μ„±ν•©λ‹λ‹¤.

## μ£Όμ” κ°λ…

### MCP Transport λ°©μ‹
MCP(Model Context Protocol)λ” LLMκ³Ό μ™Έλ¶€ λ„κµ¬ κ°„μ ν†µμ‹ μ„ μ„ν•΄ λ‹¤μ–‘ν• Transport λ°©μ‹μ„ μ§€μ›ν•©λ‹λ‹¤. MCP μ‚¬μ–‘(2025-03-26)μ— λ”°λ¥΄λ©΄ λ‹¤μκ³Ό κ°™μ€ Transport λ°©μ‹μ΄ μμµλ‹λ‹¤:

#### 1. stdio Transport
- **μ‹¤ν–‰ λ°©μ‹**: ν‘μ¤€ μ…μ¶λ ¥(stdin/stdout)μ„ ν†µν• ν†µμ‹ 
- **μ‚¬μ© ν™κ²½**: λ΅μ»¬ ν™κ²½μ—μ„ μ£Όλ΅ μ‚¬μ©
- **νΉμ§•**: ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„ ν”„λ΅μ„Έμ¤λ¥Ό μ§μ ‘ μ‹μ‘ν•κ³  κ΄€λ¦¬
- **μ¥μ **: μ„¤μ •μ΄ κ°„λ‹¨ν•κ³  μ¶”κ°€ λ„¤νΈμ›ν¬ κµ¬μ„±μ΄ ν•„μ” μ—†μ
- **μ‚¬μ© μ‚¬λ΅€**: λ΅μ»¬ κ°λ° ν™κ²½, λ‹¨μΌ μ‚¬μ©μ μ‹λ‚λ¦¬μ¤

#### 2. Streamable HTTP Transport
- **μ‹¤ν–‰ λ°©μ‹**: HTTP POSTμ™€ GETμ„ ν†µν• μ–‘λ°©ν–¥ ν†µμ‹ 
- **νΉμ§•**:
  - λ‹¨μΌ μ—”λ“ν¬μΈνΈμ—μ„ POSTμ™€ GETμ„ λ¨λ‘ μ§€μ›
  - Server-Sent Events (SSE)λ¥Ό ν†µν• μ¤νΈλ¦¬λ° μ§€μ›
  - μ„Έμ… κ΄€λ¦¬ κΈ°λ¥ μ κ³µ
- **μ¥μ **:
  - ν™•μ¥μ„± μλ” μ„λ²„-ν΄λΌμ΄μ–ΈνΈ ν†µμ‹ 
  - μ„Έμ… κΈ°λ° μƒνƒ κ΄€λ¦¬
  - μ—°κ²° μ¬κ° λ° λ©”μ‹μ§€ μ¬μ „μ†΅ μ§€μ›
- **μ‚¬μ© μ‚¬λ΅€**: ν΄λΌμ°λ“ ν™κ²½, λ‹¤μ¤‘ μ‚¬μ©μ μ‹λ‚λ¦¬μ¤

#### 3. HTTP+SSE Transport (2024-11-05 λ²„μ „)
- **μ‹¤ν–‰ λ°©μ‹**: HTTPλ¥Ό ν†µν• λ‹¨λ°©ν–¥ μ΄λ²¤νΈ μ¤νΈλ¦Ό
- **μ—”λ“ν¬μΈνΈ**: `/sse`
- **νΉμ§•**: μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅μ μ§€μ†μ μΈ λ°μ΄ν„° μ¤νΈλ¦Ό μ κ³µ
- **μ¥μ **: ν‘μ¤€ HTTPλ¥Ό μ‚¬μ©ν•μ—¬ λ°©ν™”λ²½ ν†µκ³Όκ°€ μ©μ΄ν•¨
- **μ‚¬μ© μ‚¬λ΅€**: μ¤‘μ•™ μ§‘μ¤‘μ‹ μ„λ²„, μ—¬λ¬ μ‚¬μ©μκ°€ κ³µμ ν•λ” ν™κ²½
- **νΈν™μ„±**: 2025-03-26 λ²„μ „κ³Όμ ν•μ„ νΈν™μ„± μ μ§€

### μ΄λ² λ¨λ“μ—μ„ HTTP+SSE Transportλ¥Ό μ„ νƒν• μ΄μ 

μ΄ λ¨λ“μ—μ„λ” 2024-11-05 λ²„μ „μ HTTP+SSE Transport λ°©μ‹μ„ μ‚¬μ©ν•©λ‹λ‹¤. μ΄λ” λ‹¤μκ³Ό κ°™μ€ μ΄μ  λ•λ¬Έμ…λ‹λ‹¤:

1. **κ°„λ‹¨ν• κµ¬ν„**: Streamable HTTP Transportμ— λΉ„ν•΄ κµ¬ν„μ΄ λ” κ°„λ‹¨ν•©λ‹λ‹¤.
2. **ν•μ„ νΈν™μ„±**: 2025-03-26 λ²„μ „κ³Όμ ν•μ„ νΈν™μ„±μ΄ λ³΄μ¥λμ–΄ μμµλ‹λ‹¤.
3. **νν† λ¦¬μ–Ό λ©μ **: μ΄ λ¨λ“μ λ©μ μ€ MCPμ κΈ°λ³Έ κ°λ…κ³Ό ν΄λΌμ°λ“ λ°°ν¬λ¥Ό μ΄ν•΄ν•λ” κ²ƒμ΄λ―€λ΅, λ” κ°„λ‹¨ν• Transport λ°©μ‹μ„ μ„ νƒν–μµλ‹λ‹¤.

ν–¥ν›„ ν”„λ΅λ•μ… ν™κ²½μ—μ„λ” 2025-03-26 λ²„μ „μ Streamable HTTP Transportλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ„ κ³ λ ¤ν•΄λ³Ό μ μμµλ‹λ‹¤. μ΄λ” μ„Έμ… κ΄€λ¦¬, μ—°κ²° μ¬κ°, λ©”μ‹μ§€ μ¬μ „μ†΅κ³Ό κ°™μ€ κ³ κΈ‰ κΈ°λ¥μ„ μ κ³µν•κΈ° λ•λ¬Έμ…λ‹λ‹¤.

### MCP-Server-CDK μ¤νƒ

MCP-Server-CDK μ¤νƒμ€ λ‹¤μκ³Ό κ°™μ€ AWS λ¦¬μ†μ¤λ¥Ό μƒμ„±ν•©λ‹λ‹¤:

- **VPC**: MCP μ„λ²„λ¥Ό μ„ν• λ„¤νΈμ›ν¬ ν™κ²½μ„ μ κ³µν•©λ‹λ‹¤.
- **ECS ν΄λ¬μ¤ν„°**: EC2 μΈμ¤ν„΄μ¤ κΈ°λ°μ μ»¨ν…μ΄λ„ μ‹¤ν–‰ ν™κ²½μ„ μ κ³µν•©λ‹λ‹¤.
- **EC2 μΈμ¤ν„΄μ¤**: ARM κΈ°λ° c6g.xlarge μΈμ¤ν„΄μ¤λ¥Ό μ‚¬μ©ν•μ—¬ MCP μ„λ²„λ¥Ό νΈμ¤ν…ν•©λ‹λ‹¤.
- **Application Load Balancer(ALB)**: MCP μ„λ²„λ΅μ νΈλν”½μ„ λ¶„μ‚°ν•κ³  HTTP μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•©λ‹λ‹¤.
- **ECS μ„λΉ„μ¤ λ° μ‘μ—… μ •μ**: MCP μ„λ²„ μ»¨ν…μ΄λ„λ¥Ό μ‹¤ν–‰ν•κΈ° μ„ν• μ„¤μ •μ„ μ κ³µν•©λ‹λ‹¤.
- **CloudWatch Logs**: μ„λ²„ λ΅κ·Έλ¥Ό μ €μ¥ν•κ³  λ¨λ‹ν„°λ§ν•©λ‹λ‹¤.

## μ‚¬μ „ μ¤€λΉ„μ‚¬ν•­

- AWS κ³„μ • λ° μ μ ν• κ¶ν•
- AWS CDK μ„¤μΉ
- Node.js λ° npm μ„¤μΉ

## μ‹¤μµ κ°€μ΄λ“

### μ‹¤μµ 1: MCP-Server-CDK μ¤νƒ λ°°ν¬

1. ν”„λ΅μ νΈ λ””λ ‰ν† λ¦¬λ΅ μ΄λ™ν•©λ‹λ‹¤:
   ```bash
   cd mcp-server-cdk
   ```

2. κ°€μƒ ν™κ²½μ„ ν™μ„±ν™”ν•©λ‹λ‹¤:
   ```bash
   source .venv/bin/activate  # Linux/Mac
   source.bat                 # Windows
   ```

3. ν•„μ”ν• μμ΅΄μ„±μ„ μ„¤μΉν•©λ‹λ‹¤:
   ```bash
   pip install -r requirements.txt
   ```

4. CDKλ¥Ό λ°°ν¬ν•©λ‹λ‹¤:
   ```bash
   cdk deploy
   ```

5. λ°°ν¬κ°€ μ™„λ£λλ©΄ μ¶λ ¥μ—μ„ ALB URLμ„ ν™•μΈν•κ³  κΈ°λ΅ν•΄ λ‘΅λ‹λ‹¤:
   ```
   Outputs:
   McpServerAmazonECSStack.McpServerAmazonECSStackALBHostnameOutput = McpServerAmazonECSStack-xxxxxxxxxxxx.your-region.elb.amazonaws.com
   ```
   > π’΅ **ν**: μ΄ URLμ€ λ‹¤μ λ‹¨κ³„μ—μ„ Claude Desktop μ„¤μ •μ— ν•„μ”ν•©λ‹λ‹¤.

### μ‹¤μµ 2: MCP-Remote μ„¤μΉ (Claude Desktop ν™κ²½)

mcp-remoteλ” Claude Desktopμ΄ μ„¤μΉλ λ΅μ»¬ ν™κ²½μ— μ„¤μΉν•©λ‹λ‹¤.

1. MCP-Remoteλ¥Ό μ„¤μΉν•©λ‹λ‹¤:
   ```bash
   npm install -g mcp-remote
   ```

2. μ„¤μΉκ°€ μ™„λ£λμ—λ”μ§€ ν™•μΈν•©λ‹λ‹¤:
   ```bash
   which mcp-remote
   ```
   > π’΅ **μ°Έκ³ **: MCP-Remoteλ” Claude Desktopκ³Ό MCP μ„λ²„ κ°„μ ν†µμ‹ μ„ κ΄€λ¦¬ν•λ” λ„κµ¬μ…λ‹λ‹¤.

### μ‹¤μµ 3: Claude Desktop μ„¤μ •

1. Claude Desktop μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν•©λ‹λ‹¤.

2. μ„¤μ •(Settings) λ©”λ‰΄λ΅ μ΄λ™ν•©λ‹λ‹¤.

3. "Developer" μ„Ήμ…μ„ μ°Ύμµλ‹λ‹¤.

4. "Edit Config"λ¥Ό ν†µν•΄ claude_desktop_config.jsonμ„ μ°Ύμµλ‹λ‹¤.

5. claude_desktop_config.json νμΌμ— μ•„λμ²λΌ μ„¤μ •μ„ μ¶”κ°€ν•©λ‹λ‹¤:
   ```json
   {
     "mcpServers": {
       "weather": {
         "command": "npx",
         "args": [
           "mcp-remote",
           "<YOUR-ALB-ENDPOINT>/sse",
           "--allow-http"
         ]
       }
     }
   }
   ```

6. μ„¤μ •μ„ μ €μ¥ν•κ³ , Claude Desktopμ„ μ¬μ‹¤ν–‰ν•©λ‹λ‹¤.

### μ‹¤μµ 4: μ—°κ²° ν…μ¤νΈ

1. Claude Desktopμ—μ„ μƒ λ€ν™”λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.

2. `What are the active weather alerts in Texas?` μ™€ κ°™μ€ μ§λ¬Έμ„ μ…λ ¥ν•μ—¬ μ‘λ‹µμ„ ν™•μΈν•©λ‹λ‹¤.

3. μ‘λ‹µμ΄ μ •μƒμ μΌλ΅ μ¤λ©΄ μ„¤μ •μ΄ μ™„λ£λ κ²ƒμ…λ‹λ‹¤.

## μ”μ•½
μ΄ λ¨λ“μ—μ„λ” AWS CDKλ¥Ό μ‚¬μ©ν•μ—¬ MCP μ„λ²„λ¥Ό AWS ν™κ²½μ— λ°°ν¬ν•κ³ , Claude Desktopκ³Ό μ—°κ²°ν•λ” λ°©λ²•μ„ ν•™μµν–μµλ‹λ‹¤. μ—¬λ¬ MCP Transport λ°©μ‹ μ¤‘ HTTP+SSE Transportλ¥Ό μ„ νƒν•μ—¬ μ¤‘μ•™ μ§‘μ¤‘μ‹ MCP μ„λ²„λ¥Ό κµ¬μ¶•ν–μµλ‹λ‹¤. μ΄ λ°©μ‹μ€ μ—¬λ¬ μ‚¬μ©μκ°€ κ³µμ ν•  μ μλ” ν™•μ¥μ„± μλ” ν™κ²½μ„ μ κ³µν•λ©°, ν΄λΌμ°λ“ ν™κ²½μ— μ‰½κ² λ°°ν¬ν•  μ μλ” μ¥μ μ΄ μμµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ ν™•μ¥μ„±κ³Ό μ•μ •μ„±μ„ κ°–μ¶ MCP μ„λ²„ μΈν”„λΌλ¥Ό κµ¬μ¶•ν•  μ μμµλ‹λ‹¤.

## μ°Έκ³  μλ£
- [Model Context Protocol κ³µμ‹ λ¬Έμ„](https://modelcontextprotocol.io/)
- [MCP Transport μ‚¬μ–‘](https://modelcontextprotocol.io/specification/2025-03-26/basic/transports)
- [AWS CDK λ¬Έμ„](https://docs.aws.amazon.com/cdk/latest/guide/home.html)
- [MCP-Remote GitHub μ €μ¥μ†](https://github.com/anthropic-labs/mcp-remote)